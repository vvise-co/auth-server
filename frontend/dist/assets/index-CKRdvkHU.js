var B=Object.defineProperty;var I=(r,t,a)=>t in r?B(r,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[t]=a;var M=(r,t,a)=>I(r,typeof t!="symbol"?t+"":t,a);import{r as i,a as H,N as k,O as T,u as R,b as S,L as f,B as q,R as V,c as x,d as W}from"./vendor-BQMikGGP.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))d(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&d(c)}).observe(document,{childList:!0,subtree:!0});function a(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function d(s){if(s.ep)return;s.ep=!0;const n=a(s);fetch(s.href,n)}})();var O={exports:{}},N={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G=i,J=Symbol.for("react.element"),K=Symbol.for("react.fragment"),Y=Object.prototype.hasOwnProperty,Q=G.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Z={key:!0,ref:!0,__self:!0,__source:!0};function _(r,t,a){var d,s={},n=null,c=null;a!==void 0&&(n=""+a),t.key!==void 0&&(n=""+t.key),t.ref!==void 0&&(c=t.ref);for(d in t)Y.call(t,d)&&!Z.hasOwnProperty(d)&&(s[d]=t[d]);if(r&&r.defaultProps)for(d in t=r.defaultProps,t)s[d]===void 0&&(s[d]=t[d]);return{$$typeof:J,type:r,key:n,ref:c,props:s,_owner:Q.current}}N.Fragment=K;N.jsx=_;N.jsxs=_;O.exports=N;var e=O.exports,w={},E=H;w.createRoot=E.createRoot,w.hydrateRoot=E.hydrateRoot;class X{constructor(t=""){M(this,"baseUrl");this.baseUrl=t}async fetch(t,a={}){const d=`${this.baseUrl}${t}`,s=await fetch(d,{...a,credentials:"include",headers:{"Content-Type":"application/json",...a.headers}});if(!s.ok){const n=await s.json().catch(()=>({message:"Request failed"}));throw new Error(n.message||`HTTP ${s.status}`)}return s.json()}async get(t){return this.fetch(t,{method:"GET"})}async post(t,a){return this.fetch(t,{method:"POST",body:a?JSON.stringify(a):void 0})}async delete(t){return this.fetch(t,{method:"DELETE"})}}const b=new X;async function ee(){try{return await b.get("/api/auth/me")}catch{return null}}async function re(){return b.get("/api/users")}async function te(r){return b.post(`/api/users/${r}/admin`)}async function ae(r){return b.delete(`/api/users/${r}/admin`)}async function se(){await b.post("/api/auth/logout")}const D=i.createContext(void 0);function de({children:r}){var y;const[t,a]=i.useState(null),[d,s]=i.useState(!0),n=async()=>{try{const l=await ee();a(l)}catch{a(null)}finally{s(!1)}};i.useEffect(()=>{n()},[]);const c=l=>{window.location.href=`/oauth2/authorization/${l}`},m=async()=>{try{await se()}finally{a(null),window.location.href="/login"}},o=async()=>{s(!0),await n()},u=((y=t==null?void 0:t.roles)==null?void 0:y.includes("ADMIN"))??!1;return e.jsx(D.Provider,{value:{user:t,loading:d,login:c,logout:m,refreshUser:o,isAdmin:u},children:r})}function g(){const r=i.useContext(D);if(!r)throw new Error("useAuth must be used within AuthProvider");return r}function L({requireAdmin:r,children:t}){const{user:a,loading:d,isAdmin:s}=g();return d?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})}):a?r&&!s?e.jsx(k,{to:"/dashboard",replace:!0}):t?e.jsx(e.Fragment,{children:t}):e.jsx(T,{}):e.jsx(k,{to:"/login",replace:!0})}function ne({redirectUri:r}){const{login:t}=g(),a=d=>{r&&(document.cookie=`oauth2_redirect_uri=${encodeURIComponent(r)}; path=/; max-age=600`),t(d)};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>a("google"),className:"w-full flex items-center justify-center gap-3 px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),e.jsx("span",{className:"text-gray-700 dark:text-gray-200 font-medium",children:"Continue with Google"})]}),e.jsxs("button",{onClick:()=>a("github"),className:"w-full flex items-center justify-center gap-3 px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-gray-700 dark:text-gray-200 font-medium",children:"Continue with GitHub"})]}),e.jsxs("button",{onClick:()=>a("microsoft"),className:"w-full flex items-center justify-center gap-3 px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#F25022",d:"M1 1h10v10H1z"}),e.jsx("path",{fill:"#00A4EF",d:"M1 13h10v10H1z"}),e.jsx("path",{fill:"#7FBA00",d:"M13 1h10v10H13z"}),e.jsx("path",{fill:"#FFB900",d:"M13 13h10v10H13z"})]}),e.jsx("span",{className:"text-gray-700 dark:text-gray-200 font-medium",children:"Continue with Microsoft"})]})]})}function le(){const{user:r,loading:t}=g(),a=R(),[d]=S(),s=d.get("error"),n=d.get("redirect_uri");return i.useEffect(()=>{!t&&r&&a("/dashboard",{replace:!0})},[r,t,a]),t?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"Welcome"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Sign in to continue"})]}),s&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:e.jsx("p",{className:"text-red-600 dark:text-red-400 text-sm",children:s})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8",children:e.jsx(ne,{redirectUri:n||void 0})}),e.jsx("p",{className:"text-center text-sm text-gray-500 dark:text-gray-400",children:"By signing in, you agree to our Terms of Service and Privacy Policy."})]})})}/**
 * @license lucide-react v0.359.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ie={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.359.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.359.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h=(r,t)=>{const a=i.forwardRef(({color:d="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:c,className:m="",children:o,...u},y)=>i.createElement("svg",{ref:y,...ie,width:s,height:s,stroke:d,strokeWidth:c?Number(n)*24/Number(s):n,className:["lucide",`lucide-${ce(r)}`,m].join(" "),...u},[...t.map(([l,p])=>i.createElement(l,p)),...Array.isArray(o)?o:[o]]));return a.displayName=`${r}`,a};/**
 * @license lucide-react v0.359.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=h("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.359.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=h("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.359.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=h("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.359.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=h("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.359.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=h("ShieldOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]]);/**
 * @license lucide-react v0.359.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=h("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.359.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=h("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.359.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=h("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);function A(){var c;const{user:r,logout:t}=g(),[a,d]=i.useState(!1),s=i.useRef(null);if(i.useEffect(()=>{function m(o){s.current&&!s.current.contains(o.target)&&d(!1)}return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[]),!r)return null;const n=async()=>{d(!1),await t()};return e.jsxs("div",{className:"relative",ref:s,children:[e.jsxs("button",{onClick:()=>d(!a),className:"flex items-center gap-2 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:[r.imageUrl?e.jsx("img",{src:r.imageUrl,alt:r.name,className:"w-8 h-8 rounded-full"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary-600 flex items-center justify-center text-white text-sm font-medium",children:((c=r.name)==null?void 0:c.charAt(0).toUpperCase())||"U"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-200 font-medium hidden sm:block",children:r.name}),e.jsx(oe,{className:"w-4 h-4 text-gray-500"})]}),a&&e.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-1 z-50",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:r.name}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:r.email})]}),e.jsxs(f,{to:"/profile",onClick:()=>d(!1),className:"flex items-center gap-2 px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700",children:[e.jsx(F,{className:"w-4 h-4"}),"Profile"]}),e.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-700 w-full text-left",children:[e.jsx(xe,{className:"w-4 h-4"}),"Sign out"]})]})]})}function he(){const{user:r,isAdmin:t}=g();return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:"Auth Server"}),e.jsx(A,{})]})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:["Welcome, ",r==null?void 0:r.name,"!"]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage your authentication and account settings."})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Account Information"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Email"}),e.jsx("p",{className:"text-gray-900 dark:text-gray-100",children:r==null?void 0:r.email})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Provider"}),e.jsx("p",{className:"text-gray-900 dark:text-gray-100 capitalize",children:r==null?void 0:r.provider.toLowerCase()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Roles"}),e.jsx("div",{className:"flex gap-2 mt-1",children:r==null?void 0:r.roles.map(a=>e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${a==="ADMIN"?"bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-300":"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300"}`,children:a},a))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Member since"}),e.jsx("p",{className:"text-gray-900 dark:text-gray-100",children:r!=null&&r.createdAt?new Date(r.createdAt).toLocaleDateString():"N/A"})]})]})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(f,{to:"/profile",className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 hover:shadow-md transition-shadow flex items-center gap-4",children:[e.jsx("div",{className:"bg-primary-100 dark:bg-primary-900/30 p-3 rounded-lg",children:e.jsx(F,{className:"w-6 h-6 text-primary-600 dark:text-primary-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Profile"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"View and edit your profile"})]})]}),t&&e.jsxs(f,{to:"/users",className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 hover:shadow-md transition-shadow flex items-center gap-4",children:[e.jsx("div",{className:"bg-purple-100 dark:bg-purple-900/30 p-3 rounded-lg",children:e.jsx(ge,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:"User Management"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Manage users and roles"})]})]}),t&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 flex items-center gap-4 opacity-75",children:[e.jsx("div",{className:"bg-green-100 dark:bg-green-900/30 p-3 rounded-lg",children:e.jsx(z,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Admin Panel"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"You have admin access"})]})]})]})]})]})}function ue(){var t;const{user:r}=g();return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(f,{to:"/dashboard",className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx($,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),e.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:"Profile"})]}),e.jsx(A,{})]})}),e.jsx("main",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-primary-500 to-primary-600 px-6 py-8",children:e.jsxs("div",{className:"flex items-center gap-4",children:[r!=null&&r.imageUrl?e.jsx("img",{src:r.imageUrl,alt:r.name,className:"w-20 h-20 rounded-full border-4 border-white shadow-lg"}):e.jsx("div",{className:"w-20 h-20 rounded-full bg-white flex items-center justify-center text-primary-600 text-2xl font-bold shadow-lg",children:((t=r==null?void 0:r.name)==null?void 0:t.charAt(0).toUpperCase())||"U"}),e.jsxs("div",{className:"text-white",children:[e.jsx("h2",{className:"text-2xl font-bold",children:r==null?void 0:r.name}),e.jsx("p",{className:"opacity-90",children:r==null?void 0:r.email})]})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Account Details"}),e.jsxs("dl",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[e.jsx("dt",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Full Name"}),e.jsx("dd",{className:"mt-1 text-gray-900 dark:text-gray-100 font-medium",children:r==null?void 0:r.name})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[e.jsx("dt",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Email Address"}),e.jsx("dd",{className:"mt-1 text-gray-900 dark:text-gray-100 font-medium",children:r==null?void 0:r.email})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[e.jsx("dt",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Auth Provider"}),e.jsx("dd",{className:"mt-1 text-gray-900 dark:text-gray-100 font-medium capitalize",children:r==null?void 0:r.provider.toLowerCase()})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[e.jsx("dt",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Account Created"}),e.jsx("dd",{className:"mt-1 text-gray-900 dark:text-gray-100 font-medium",children:r!=null&&r.createdAt?new Date(r.createdAt).toLocaleDateString():"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Roles"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r==null?void 0:r.roles.map(a=>e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${a==="ADMIN"?"bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-300":"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300"}`,children:a},a))})]})]})]})})]})}function pe(){const{user:r}=g(),[t,a]=i.useState([]),[d,s]=i.useState(!0),[n,c]=i.useState(null),[m,o]=i.useState(null);i.useEffect(()=>{u()},[]);const u=async()=>{try{s(!0);const l=await re();a(l),c(null)}catch(l){c(l instanceof Error?l.message:"Failed to load users")}finally{s(!1)}},y=async(l,p)=>{try{o(l),p?await ae(l):await te(l),await u()}catch(j){c(j instanceof Error?j.message:"Failed to update user")}finally{o(null)}};return d?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(P,{className:"w-8 h-8 animate-spin text-primary-600"})}):n?e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-600 dark:text-red-400",children:n}),e.jsx("button",{onClick:u,className:"mt-2 text-sm text-red-700 dark:text-red-300 underline",children:"Try again"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Provider"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Roles"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Joined"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:t.map(l=>{var U;const p=l.roles.includes("ADMIN"),j=l.id===(r==null?void 0:r.id),C=m===l.id;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[l.imageUrl?e.jsx("img",{src:l.imageUrl,alt:l.name,className:"w-10 h-10 rounded-full"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-primary-600 flex items-center justify-center text-white font-medium",children:((U=l.name)==null?void 0:U.charAt(0).toUpperCase())||"U"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:l.name}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:l.email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200 capitalize",children:l.provider.toLowerCase()})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex gap-1",children:l.roles.map(v=>e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${v==="ADMIN"?"bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-300":"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300"}`,children:v},v))})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:new Date(l.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx("button",{onClick:()=>y(l.id,p),disabled:j||C,className:`inline-flex items-center gap-1 px-3 py-1 rounded-md text-sm ${j?"bg-gray-100 dark:bg-gray-800 text-gray-400 cursor-not-allowed":p?"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 hover:bg-red-200 dark:hover:bg-red-900/50":"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 hover:bg-purple-200 dark:hover:bg-purple-900/50"}`,children:C?e.jsx(P,{className:"w-4 h-4 animate-spin"}):p?e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"w-4 h-4"}),"Remove Admin"]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-4 h-4"}),"Make Admin"]})})})]},l.id)})})]})})}function ye(){return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(f,{to:"/dashboard",className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx($,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),e.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:"User Management"})]}),e.jsx(A,{})]})}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"All Users"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Manage user roles and permissions"})]}),e.jsx(pe,{})]})})]})}function fe(){const[r,t]=i.useState(null),[a]=S(),d=R(),{refreshUser:s}=g();return i.useEffect(()=>{const n=a.get("error");if(n){t(n);return}(async()=>{try{await s(),d("/dashboard",{replace:!0})}catch{t("Failed to complete authentication")}})()},[a,d,s]),r?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:e.jsx("div",{className:"max-w-md w-full space-y-8 p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-red-600",children:"Authentication Error"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:r}),e.jsx(f,{to:"/login",className:"mt-4 inline-block px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:"Back to Login"})]})})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"Completing sign in..."})]})})}function je(){return e.jsx(de,{children:e.jsx(q,{children:e.jsxs(V,{children:[e.jsx(x,{path:"/login",element:e.jsx(le,{})}),e.jsx(x,{path:"/auth/callback",element:e.jsx(fe,{})}),e.jsxs(x,{element:e.jsx(L,{}),children:[e.jsx(x,{path:"/dashboard",element:e.jsx(he,{})}),e.jsx(x,{path:"/profile",element:e.jsx(ue,{})})]}),e.jsx(x,{element:e.jsx(L,{requireAdmin:!0}),children:e.jsx(x,{path:"/users",element:e.jsx(ye,{})})}),e.jsx(x,{path:"/",element:e.jsx(k,{to:"/dashboard",replace:!0})}),e.jsx(x,{path:"*",element:e.jsx(k,{to:"/dashboard",replace:!0})})]})})})}w.createRoot(document.getElementById("root")).render(e.jsx(W.StrictMode,{children:e.jsx(je,{})}));
